
##### PWM ç®€å•è®²è§£

![[../../annex/16.å…¥èŒç¬¬åå…­å‘¨10.27-11.1(å•ä¼‘)_image_1.png]]

![[../../annex/16.å…¥èŒç¬¬åå…­å‘¨10.27-11.1(å•ä¼‘)_image_2.png]]

PWM æœ€é‡è¦çš„å‚æ•°ä¸€ä¸ªæ˜¯å ç©ºæ¯”ï¼Œå°±æ˜¯å‘¨æœŸå†…é«˜ç”µå¹³æŒç»­çš„æ—¶é—´ã€‚
ç¬¬äºŒä¸ªå°±æ˜¯é¢‘ç‡ï¼Œå°±æ˜¯ 1 ç§’äº§ç”Ÿå¤šå°‘ä¸ªå‘¨æœŸ

èœ‚é¸£å™¨ä¸Šï¼Œé¢‘ç‡ä¸»è¦è°ƒèŠ‚éŸ³è°ƒé«˜ä½ï¼Œå ç©ºæ¯”è°ƒèŠ‚éŸ³é‡å¤§å°
é›¾åŒ–å™¨è¿™ä¸ªä¸Šé¢ï¼Œç”µæœºé©±åŠ¨çš„è¯ï¼Œå ç©ºæ¯”æ§åˆ¶å‡ºé›¾é‡ï¼Œé¢‘ç‡å¥½åƒæ§åˆ¶è½¬åŠ¨äº§ç”Ÿçš„å™ªå£°
ä¸è¿‡ç†è®ºä¸Šå¯ä»¥ç”¨ä»£ç è®©ä»–ä¸€ç›´å¿«é€Ÿç¿»è½¬ç”µå¹³ï¼Œæ¨¡æ‹Ÿå®ç° PWM

![[../../annex/16.å…¥èŒç¬¬åå…­å‘¨10.27-11.1(å•ä¼‘)_image_3.jpg]]


AXD-303A,æˆ‘ä¹‹å‰è¯•ç€ç”¨è½¯ä»¶å»æ¨¡æ‹Ÿè¾“å‡º PWMï¼Œå‘ç°ç›´æ¥é©±åŠ¨ä¸äº†ï¼Œä¸»è¦åŸå› å°±æ˜¯è¿™ç©æ„æœ¬è´¨å°±æ˜¯é«˜é€Ÿå¼€å…³ç”µè·¯ï¼Œä½†æ˜¯303A æ˜¯ç»§ç”µå™¨å¼€å…³ï¼Œç»§ç”µå™¨ä¸æ”¯æŒ us çº§åˆ«é«˜é€Ÿå¼€å…³ï¼Œæ‰€ä»¥ç›´æ¥å°±ç”¨ä¸äº†ã€‚ä¸€èˆ¬å¥½åƒç”¨ mos ç®¡


##### é›¾åŒ–å™¨ N300ä¿®æ”¹ä¸º 2 ä¸ªè§¦æ‘¸æŒ‰é”®ï¼Œå¹¶å¢åŠ  1ä¸ª LED ç¯
é›¾åŒ–å™¨ N300 ç”±3 ä¸ªè§¦æ‘¸æŒ‰é”®ä¿®æ”¹ä¸º 2 ä¸ªè§¦æ‘¸æŒ‰é”®ï¼Œå¹¶å¢åŠ äº†ä¸€ä¸ªç”µæºé€šç”µçš„ LED ç¯
è¯¥ LED ç¯åœ¨ç¬¬ 3 ä¸ªåœ°å€å¤„ï¼Œæ‰€ä»¥ä¸€ç›´æ²¡èƒ½ç‚¹äº®ï¼Œæ–¹æ³•ä¹Ÿç”¨é”™äº†ã€‚
ç»™æ‰€æœ‰åœ°å€èµ‹å€¼åå…¨äº® (å…¨æ˜¾å‡½æ•°å¯äº®)ï¼Œåº”è¯¥é€šè¿‡ä½åç§»é€ä¸ªç‚¹äº® LED ç¯çš„æ–¹å¼å»æ¨æ–­æ–°å¢çš„ LED ç¯æ‰€å¤„çš„åœ°å€æ˜¯å“ªé‡Œã€‚

```
for(i=0x01;i<16;i++)
{
	ShowIcon2(a,1);
	ShowIcon2(a,2);
	ShowIcon2(a,3);
	ShowIcon2(a,4);
	//ShowIcon(i,2);
	a<<=1;
	Delay_ms(200);
}
```

```
uint8 testi=0;
unsigned char a=0x01;
unsigned char b = 0;
void main(void)
{	
	asm("nop");
	asm("clrwdt");
	OSCCON = 0X70;
	OPTION_REG = 0;
	SysInit();
	GIE=1;  //å…¨å±€ä¸­æ–­
	InitialLed();
	TouchKeyInit_System();
	delay(10);
	//uart_init();
	//Pwm4Enable(); //test
	Buzzertime=0;
	WorkState=0;
	FreshLEDFlag=1;
	
	Pwm1Enable();
	Delay_ms(200);
	Pwm1Disable();
	//TRISA1 = 0;
	//Pwm1Enable();
	
	if(b==0) {b++;ShowIcon2(0xFF,3);}
	
	while(1)
	{	
		//asm("CLR PORTB");
		//SendNumx(0);
		// 1ï¼Œå®ç°æŒ‰é”®åŠŸèƒ½ï¼ˆè§¦æ‘¸ï¼‰
		// 2ï¼Œä¸²å£æ‰“å°
		// 3ï¼ŒåŠ å…¥pwm
		
		/*Pwm1Enable();
		Delay_ms(200);
		Pwm1Disable();
		Delay_ms(200);*/
		//ShowIcon(0x80,1);
		//Delay_ms(200);
		
		/*for(i=0x01;i<16;i++)
		{
			ShowIcon2(a,1);
			ShowIcon2(a,2);
			ShowIcon2(a,3);
			ShowIcon2(a,4);
			//ShowIcon(i,2);
			a<<=1;
			Delay_ms(200);
		}*/
		
		/*ShowAllIcon();
		Delay_ms(500);
		DarkAllIcon();
		Delay_ms(500);*/
		
		/*Pwm1Enable();
		Pwm4Enable();*/
		
		if (B_MainLoop) {
			B_MainLoop = 0;
		//	CLRWDT();
			CheckTouchKey();

			Refurbish_Sfr();
			KeyServer();
			
			if(FreshLEDFlag==1) {ShowRealTime(SetRealTime);FreshLEDFlag=0;}
			
			if(WorkState!=0) Pwm4Enable();
			else if(WorkState==0) Pwm4Disable();			
		}
		if(WorkState==0) Pwm4Disable();	
		if(b!=0) {b=0;ShowIcon2(0xFF,3);}	
	}
}
```
å®é™…ä¸ŠåŸç†å›¾ä¸Šä¹Ÿå·²ç»å†™æ˜äº†ï¼ŒL15 ç¯åœ¨ R3 ä¸Šï¼ŒR1ã€R2ã€R3 åˆ†åˆ«å¯¹åº”ç¬¬ 1ã€2ã€3 åœ°å€ï¼ˆ0x68ã€0x6Aã€0x6Dï¼‰
![[../../annex/16.å…¥èŒç¬¬åå…­å‘¨10.27-11.1(å•ä¼‘)_image_4.png]]

![[../../annex/16.å…¥èŒç¬¬åå…­å‘¨10.27-11.1(å•ä¼‘)_image_5.png]]





##### AXD-840 E

g_s_set.flag_spk_on_off

###### ç”µé‡æ ¼æ•°æ˜¾ç¤ºé—®é¢˜
```

#define R 4  (300 ul)     //500 K  åˆ†å‹ç”µé˜»
#define R 5  (240 ul)     //100 K
#define SARADC_FULLRANGE  (4095 ul) //adc æœ€å¤§é‡ç¨‹
#define SARADC_REFV     (180 ul)  //å‚è€ƒç”µå‹ avddr 2.4 v - acm 1.2 v = 1.8 v
#define V_OFFSET  ((g_s_func. E_power_type == DRY_BAT) ? ((uint 32_t) 282 ul) : ((uint 32_t) 267 ul)) //è¡¥å¿ 
#define V_OFFSET  ((g_s_func. E_power_type == DRY_BAT) ? ((uint 32_t) 292 ul) : ((uint 32_t) 267 ul)) //è¡¥å¿ 
#define V_OFFSET  ((g_s_func. E_power_type == DRY_BAT) ? ((uint 32_t) 296 ul) : ((uint 32_t) 267 ul)) //è¡¥å¿ 


#define CHECK_LIMIT (10 ul) //æœ€å°æ£€æµ‹æ¬¡æ•°å³å–å¹³å‡æ¬¡æ•°


//ä½ç”µå‹è§¦å‘é˜ˆå€¼
#define LOW_BAT_VAL ((g_s_func. E_power_type == DRY_BAT) ? ((uint 32_t) 420) : ((uint 32_t) 340))
```


```
//BAT
//uint16  bat_val_table_BAT[] = {425, 490 , 575 ,0xffff};//æœ€å¤§ - æœ€å° / (æ ¼æ•° - 1) =  æ¯æ ¼ç”µå‹
uint16  bat_val_table_BAT[] = {425, 485 , 570 ,0xffff};//æœ€å¤§ - æœ€å° / (æ ¼æ•° - 1) =  æ¯æ ¼ç”µå‹
uint16  bat_val_table_BAT[] = {425, 485 , 565 ,0xffff};//æœ€å¤§ - æœ€å° / (æ ¼æ•° - 1) =  æ¯æ ¼ç”µå‹
//LI
uint16  bat_val_table[] = {300, 360 , 395 ,0xffff};//æœ€å¤§ - æœ€å° / (æ ¼æ•° - 1) =  æ¯æ ¼ç”µå‹
```

###### SET é”®è®°å¿†ç´¢å¼•é—®é¢˜

![[../../annex/16.å…¥èŒç¬¬åå…­å‘¨10.27-11.1(å•ä¼‘)_image_6.png]]



```
if (KEY_MEM == 0)
        {
            if (flag_first_single_mem == 0)
            {
                //å¹³å‡è®°å¿†è·³è½¬æŸ¥ç¬¬ä¸€ç»„ä¸éœ€è¦æ”¹å˜ä¸‹æ ‡
                flag_first_single_mem = 1;
							Fresh_timecolon_flag = 2;
                if (KEY_MEM == 0)//æ¸…é™¤è®°å¿†
			    {
                    off_time_tick_clr();
                    while (KEY_MEM == 0)	//MEMé”®é•¿æŒ‰æ£€æµ‹(å¿«ç¿»åŠŸèƒ½)
				    {
                        if (KEY_MEM == 0 && KEY_POWER == 1)
                        {
                            if (get_cur_off_time_tick() > OFF_TIME_TICK_1S_COUNT * 2)
						    {
                                // sys_icon_off;
                                // sys_mmhg_icon_off;
                                // sys_point_icon_off;
                                aky_disp_clear_all();
                                line_icon_on;
                                avg_mid_new_on;
                                show_voice();
                                disp_user_icon(g_s_set.e_user);
						    	goto men_next2;
						    }
                        }
                    }
                    wait_all_key_release();
                }
            }
            else
            {
                if (KEY_MEM == 0)//æ¸…é™¤è®°å¿†
			    {
                    off_time_tick_clr();
                    while (KEY_MEM == 0)	//MEMé”®é•¿æŒ‰æ£€æµ‹(å¿«ç¿»åŠŸèƒ½)
                    {
                        if(KEY_MEM == 0 && KEY_POWER == 1)
					    {
					    	if (get_cur_off_time_tick() > OFF_TIME_TICK_1S_COUNT * 2)
					    	{
                                aky_disp_clear_all();
                                line_icon_on;
                                avg_mid_new_on;
                                show_voice();
                                disp_user_icon(g_s_set.e_user);
					    		goto men_next;
					    	}
					    }
                    }
                    
                }
men_next:
                //æ­£å‘æŸ¥è®°å¿†
                s_mem_index_temp.cur_mem_index--;
                if (s_mem_index_temp.cur_mem_index == 0)	//è¾¹ç•Œæ£€æŸ¥ä¸å¤„ç†
                {
                    if (s_mem_index_const.flag_mem_overwrite == 1)
                    {
                        s_mem_index_temp.cur_mem_index = s_mem_index_const.mem_set;	//è®°å¿†å·²æ»¡
                    }
                    else
                    {
                        s_mem_index_temp.cur_mem_index = s_mem_index_const.cur_mem_index;	//è®°å¿†æœªæ»¡
                    }
                }
            }
            while (KEY_POWER == 0 || KEY_MEM == 0)	//ç­‰å¾…æŒ‰é”®é‡Šæ”¾,åŒæ—¶æ£€æµ‹å¿«ç¿»
            {
                while (KEY_MEM == 0)
                {
                    if (get_cur_off_time_tick() > OFF_TIME_TICK_1S_COUNT * 1)
					{
                        men_next2:
                        // aky_disp_clear_all();
						g_s_mem = flash_get_mem_data(g_s_set.e_user, s_mem_index_temp.cur_mem_index, &g_e_flash_err, MAIN_ADDR);	// å¿«ç¿»æ¨¡å¼ï¼šå¿«é€Ÿæ˜¾ç¤ºä¸‹ä¸€æ¡è®°å¿†
						// disp_result_sys_dia(g_s_mem);
						// show_who(g_s_mem);

						// disp_to_pul(g_s_mem.pul, 1);
                        // if(g_s_mem.flag_AFF ==1)
			            // {
			            // 	AFIconOn;
			            // }
			            // else
			            // {
			            // 	AFIconOff;
			            // }	
                        // pad_icon_off;
						// flash_disp_pad_cuff_move_control(g_s_mem, 1); // æ˜¾ç¤ºpad ï¼Œä¸æ˜¾ç¤ºcuff move
						// flash_disp_pul_hight_low_control(g_s_mem, 1); //
						// if (g_s_func.e_time_sys != NO_TIME_DISP)
						// {
						// 	disp_mon_day(g_s_mem.s_time, 1);
						// 	disp_hour_min(g_s_mem.s_time, 1);
						// }
						if (s_mem_index_const.flag_mem_overwrite == 1)	// è®¡ç®—å¹¶æ˜¾ç¤ºè®°å¿†åºå·
						{
							if (s_mem_index_temp.cur_mem_index <= s_mem_index_const.cur_mem_index)
							{
								disp_to_mem_set((s_mem_index_const.cur_mem_index - s_mem_index_temp.cur_mem_index) + 1, 1);
							}
							else
							{
								disp_to_mem_set(s_mem_index_const.mem_set - ((s_mem_index_temp.cur_mem_index - s_mem_index_const.cur_mem_index) - 1), 1);
							}
						}
						else
						{
							disp_to_mem_set((s_mem_index_const.cur_mem_index - s_mem_index_temp.cur_mem_index) + 1, 1);
						}
						aky_tick_delay_ms(300);
						goto men_next;			// ç»§ç»­å¿«ç¿»		
					}
                }
                off_time_tick_clr();
                    
            }
        }
        else if (KEY_SET == 0)
				{
            if (flag_first_single_mem == 0)
            {
                flag_first_single_mem = 1;
							Fresh_timecolon_flag = 2;
							s_mem_index_temp.cur_mem_index=1;		//å¹³å‡è®°å¿†è·³è½¬æŸ¥ç¬¬ä¸€ç»„éœ€è¦æ”¹å˜ä¸‹æ ‡
                if (KEY_SET == 0)
			    {
                    off_time_tick_clr();
                    while (KEY_SET == 0)	//SETé”®é•¿æŒ‰æ£€æµ‹(å¿«ç¿»åŠŸèƒ½)
				    {
                        if (KEY_SET == 0 && KEY_POWER == 1)
                        {
                            if (get_cur_off_time_tick() > OFF_TIME_TICK_1S_COUNT * 2)
						    {
                                // sys_icon_off;
                                // sys_mmhg_icon_off;
                                // sys_point_icon_off;
                                aky_disp_clear_all();
                                line_icon_on;
                                avg_mid_new_on;
                                show_voice();
                                disp_user_icon(g_s_set.e_user);
						    	goto men_next4;
						    }
                        }
                    }
                    wait_all_key_release();
                }
            }
            else
            {
                if (KEY_SET == 0)//æ¸…é™¤è®°å¿†
			    {
                    off_time_tick_clr();
                    while (KEY_SET == 0)	//SETé”®é•¿æŒ‰æ£€æµ‹(å¿«ç¿»åŠŸèƒ½)
                    {
                        if(KEY_SET == 0 && KEY_POWER == 1)
					    {
					    	if (get_cur_off_time_tick() > OFF_TIME_TICK_1S_COUNT * 2)
					    	{
                                aky_disp_clear_all();
                                line_icon_on;
                                avg_mid_new_on;
                                show_voice();
                                disp_user_icon(g_s_set.e_user);
					    		goto men_next3;
					    	}
					    }
                    }
                    
                }
men_next3:
                //åå‘æŸ¥è®°å¿†
                s_mem_index_temp.cur_mem_index++;
                if (s_mem_index_temp.cur_mem_index > s_mem_index_const.cur_mem_index)	//è¾¹ç•Œæ£€æŸ¥ä¸å¤„ç†
                {
                    if (s_mem_index_const.flag_mem_overwrite == 1)
                    {
                        if(s_mem_index_temp.cur_mem_index > s_mem_index_const.mem_set)//è®°å¿†å·²æ»¡
												{
													s_mem_index_temp.cur_mem_index = 1;
												}													
                    }
                    else
                    {
                        s_mem_index_temp.cur_mem_index = 1;	//è®°å¿†æœªæ»¡
                    }
                }
            }
            while (KEY_POWER == 0 || KEY_SET == 0)	//ç­‰å¾…æŒ‰é”®é‡Šæ”¾,åŒæ—¶æ£€æµ‹å¿«ç¿»
            {
                while (KEY_SET == 0)
                {
                    if (get_cur_off_time_tick() > OFF_TIME_TICK_1S_COUNT * 1)
					{
                        men_next4:
                        // aky_disp_clear_all();
						g_s_mem = flash_get_mem_data(g_s_set.e_user, s_mem_index_temp.cur_mem_index, &g_e_flash_err, MAIN_ADDR);	// å¿«ç¿»æ¨¡å¼ï¼šå¿«é€Ÿæ˜¾ç¤ºä¸‹ä¸€æ¡è®°å¿†
						// disp_result_sys_dia(g_s_mem);
						// show_who(g_s_mem);

						// disp_to_pul(g_s_mem.pul, 1);
                        // if(g_s_mem.flag_AFF ==1)
			            // {
			            // 	AFIconOn;
			            // }
			            // else
			            // {
			            // 	AFIconOff;
			            // }	
                        // pad_icon_off;
						// flash_disp_pad_cuff_move_control(g_s_mem, 1); // æ˜¾ç¤ºpad ï¼Œä¸æ˜¾ç¤ºcuff move
						// flash_disp_pul_hight_low_control(g_s_mem, 1); //
						// if (g_s_func.e_time_sys != NO_TIME_DISP)
						// {
						// 	disp_mon_day(g_s_mem.s_time, 1);
						// 	disp_hour_min(g_s_mem.s_time, 1);
						// }
						if (s_mem_index_const.flag_mem_overwrite == 1)	// è®¡ç®—å¹¶æ˜¾ç¤ºè®°å¿†åºå·
						{
							if (s_mem_index_temp.cur_mem_index <= s_mem_index_const.cur_mem_index)
							{
								disp_to_mem_set((s_mem_index_const.cur_mem_index - s_mem_index_temp.cur_mem_index) + 1, 1);
							}
							else
							{
								disp_to_mem_set(s_mem_index_const.mem_set - ((s_mem_index_temp.cur_mem_index - s_mem_index_const.cur_mem_index) - 1), 1);
							}
						}
						else
						{
							disp_to_mem_set((s_mem_index_const.cur_mem_index - s_mem_index_temp.cur_mem_index) + 1, 1);
						}
						aky_tick_delay_ms(300);
						goto men_next3;			// ç»§ç»­å¿«ç¿»		
					}
                }
                off_time_tick_clr();
                    
            }
        }
```




##### AXD-846 E, ä¿®æ”¹è®°å¿†ç´¢å¼•
é‡åˆ°çš„ç°è±¡ï¼šé™éŸ³æ—¶ï¼Œè®°å¿†åªèƒ½æŸ¥çœ‹å¹³å‡è®°å¿†ä»¥åŠç¬¬ä¸€ç»„è®°å¿†å†…å®¹ï¼Œç´¢å¼•å€¼æ— æ³•è¿›è¡Œæ›´æ–°ï¼›å£°éŸ³å¼€å¯æ—¶èƒ½å¤Ÿæ­£å¸¸ç´¢å¼•æ‰€æœ‰è®°å¿†å†…å®¹ã€‚

çˆ±èŠ¯è¾¾ AXD-846 E æ”¹å±å¹•ä¸­æ–‡å¸¦æˆ¿é¢¤é¡¹ç›®-BP 004C
ä¿®æ”¹å†…å®¹ï¼š
1ã€ä¿®æ”¹ä¸Šç¬”è®°å¿†æ˜¾ç¤ºä¸­ï¼Œè„‰æçš„ç™¾ä½æ•°æ®ä¸æ˜¾ç¤ºçš„é—®é¢˜ã€‚
2ã€ä¿®æ”¹è®°å¿†ç»„æ•°ä¸º 4 ç»„æ•°æ®æ—¶é•¿æŒ‰è®°å¿†é”®æ˜¾ç¤ºç¬¬äº”ç»„æ•°æ®ï¼Œé«˜å‹ 255ï¼Œä½å‹ 255ï¼Œå¿ƒç‡ Hi çš„é—®é¢˜ã€‚
3ã€ä¿®æ”¹è®°å¿†ç»„æ•°ä¸º 90 æ—¶é•¿æŒ‰è®°å¿†é”®è®°å¿†ç»„æ•°æ˜¾ç¤ºä¸º 91ï¼Œä¸ä¼šåˆ‡æ¢åˆ°ç¬¬ä¸€ç»„æ•°æ®çš„é—®é¢˜ã€‚
4ã€ä¿®æ”¹è®°å¿†ç´¢å¼•è¶Šç•Œæ—¶ï¼Œåœç•™åœ¨ç¬¬ 1 ç¬”è®°å¿†çš„é—®é¢˜ã€‚



![[../../annex/16.å…¥èŒç¬¬åå…­å‘¨10.27-11.1(å•ä¼‘)_image_7.png]] 


Test
![[../../annex/16.å…¥èŒç¬¬åå…­å‘¨10.27-11.1(å•ä¼‘)_image_8.png]]

###### 01
```
/*BB=PUMP | VALVE;	
				iocontroloff();	
					IsAlgoEnd=1;
					testii++;
				SystolicValuew = 110+testii;
				//SystolicValue1b++;
				DiastolicValue = 60+testii;	
					
				PulseRate = 60+testii;
				ResultCode=0;
				AFFlag = 1;		*/
```


![[../../annex/16.å…¥èŒç¬¬åå…­å‘¨10.27-11.1(å•ä¼‘)_image_9.png]]

![[../../annex/16.å…¥èŒç¬¬åå…­å‘¨10.27-11.1(å•ä¼‘)_image_10.png]]

###### 02
```
if(VoiceEnable==1)
	{
		//tomemorykeyinX(MemoryEndIndex);
		if(KEY_MEMORYUP)  SoundMemory();
		//if(VoiceStop) goto ChangeMemoryIndex2;	
	}

if(flag_tomemory_long_press==1)
{
	flag_tomemory_long_press = 0;
	goto ChangeMemoryIndex2;
}
```

###### 03
```tomemorykeyin
void tomemorykeyinX(unsigned char MemoryIndex)
{
//	unsigned char i;
	MemoryMode=1;
	if(last_memory_flag == 0)
	DarkAllIcon();
	last_memory_flag = 1;
	EEPROMin= MemoryIndex;
	readM24L16();
	PulseRam[1].b[0] = inbyte[0];  	/*systolic  pressure*/
	PulseRam[2].b[0] = inbyte[1];  	/*diastolic  pressure*/
	PulseRam[3].b[0] = inbyte[2];  	/*heart rate*/
    PulseRam[9].b[0] = inbyte[3];  	/*M0_data*/
	PulseRam[6].b[0] = inbyte[4];  	/*M1_hour*/
//	PulseRam[7].b[0] = inbyte[5];  	/*Minute*/
 	PulseRam[7].b[0] = (inbyte[5]&0x3f);  	/*Minute ?PAD????*/
	PulseRam[8].b[0] = (inbyte[6]&0x80);
	PulseRam[4].b[0] = (PulseRam[9].b[0]&0xc0)/64 + (PulseRam[6].b[0]&0xc0)/16;/*month*/
	PulseRam[5].b[0] = PulseRam[9].b[0]&0x1f;    /*date*/
	PulseRam[6].b[0] &= 0x1f;  	/*hour*/

	MemoryIconOn;//MarkMEMORY = 1;			//MR icon display
//	DIAIconOn;SYSIconOn;
	if (CuffDetect)
    {
        if((inbyte[5] & 0x40)==0x40)//CuffOKFlag å­˜æ”¾ä½ç½®
            CuffOKFlag = 1;
        else
            CuffOKFlag = 0;
    }

    if (MoveDetect)
    {
        if((inbyte[3] & 0x20)==0x20)//MoveFlag å­˜æ”¾ä½ç½®
            MoveFlag = 1;
        else
            MoveFlag = 0;
    }
	
	if((inbyte[4] & 0x20)==0x20)
		{AFFlag=1;}
	else
		{AFFlag=0;}	
	
	if((inbyte[5] & 0x80)==0x80)
		{PADFlag=1;}
	else
		{PADFlag=0;}

}

/**********************************************************/
void tomemorykeyin(void)
{
	unsigned char	i;
//Again:
	MemoryMode=1;

	Vioce_LBT_Flag = 1;
	last_memory_flag=0;
	HaveMemoryAvg=0;
	HaveMemoryAvg1=0;
	HaveMemoryFirst=1;
	MemoryClredFlag=0;
	Start_mmHgKpaFlag = 0;

	checkmemorybankAB();
	MemoryMode=1;
	EEPROMin = 0;
	readM24L16();
//**********************************************20110503????ï¿½ï¿½??ï¿½ï¿½????????ï¿½ï¿½ï¿½ï¿½??????ï¿½ï¿½??ï¿½ï¿½??.
	MemoryEndIndex = inbyte[0]-1;		//reload first address	//??????ï¿½ï¿½??ï¿½ï¿½????????????index

	if(MemoryFull)	{MemoryIndex = MemorySet;}	//load memory count //???????ï¿½ï¿½???? ????full,?ï¿½ï¿½????.
	else			{MemoryIndex = MemoryEndIndex;}	//????????full,?ï¿½ï¿½ï¿½ï¿½??ï¿½ï¿½????????????????.

	if((MemoryEndIndex==0 && MemoryFull==0)||(ReadEepromError==1)||(MemoryEndIndex>MemorySet)) // No memory display "No M"
	{
		DarkAllIcon();
		AutoOffTimew=0;
		DisplayHalfByte(0x16,MemorySetTen); //n
		DisplayHalfByte(0x14,MemorySetSingle);//o
		MemoryIconOn;//MarkMEMORY = 1;			//MR icon display
		UserABDisplay();
		parting_line_off;
		
		do{}while(!KEY_MEMORYUP);
		delay(4);
		do{}while((AutoOffTimew <= 350)&&KEY_TIME&&KEY_POWER&&KEY_MEMORYUP);
		do{}while(!KEY_MEMORYUP||!KEY_TIME);
		delay(2);
		do{}while(!KEY_MEMORYUP||!KEY_TIME);
		goto TimeOver;
	}

	SysMeanEnd=DiaMeanEnd=PulseMeanEnd=0;
	if(MemoryFull==0)
		{
			if(AverageSet>MemoryEndIndex)
			{AverageSet=MemoryEndIndex;}
		}
		
//	if((MemoryEndIndex<3) && (!MemoryFull))
//	{
//		ShowMean = 0;
//	}				
		
	if(((MemoryEndIndex>0)||(MemoryFull==1))&&ShowMean)		//?????????????ï¿½ï¿½??1,??????????????????,
		{
			DarkAllIcon();
			DisplayHalfByte(0x0a,MemorySetTen);  //????AV
			DisplayHalfByte(0x18,MemorySetSingle);
			for(i=0;i<AverageSet;i++)
				{
					EEPROMin = MemoryEndIndex;
					readM24L16();
					SysMeanEnd += inbyte[0];
					DiaMeanEnd += inbyte[1];
					PulseMeanEnd += inbyte[2];

                    MemoryEndIndex--;
                    if(MemoryEndIndex==0){MemoryEndIndex = MemorySet;}
                }

			SysMeanEnd /=AverageSet;
			DiaMeanEnd /= AverageSet;
			PulseMeanEnd /= AverageSet;
		}

//	while(KEY_TIME && KEY_POWER)		//????power or time key??ï¿½ï¿½???,?ï¿½ï¿½????????????
	while(KEY_POWER)					//20111211????power?ï¿½ï¿½????????????
	{
//NextMem:
		if(HaveMemoryAvg==0)
		{
			HaveMemoryAvg1=1;

			EEPROMin = 0;
			readM24L16();
			MemoryEndIndex = inbyte[0]-1;		//reload first address	//??????ï¿½ï¿½??ï¿½ï¿½????????????index

			if(MemoryFull) 	MemoryIndex = MemorySet;	//load memory count //???????ï¿½ï¿½???? ????full,?ï¿½ï¿½????.
			else		MemoryIndex = MemoryEndIndex;	//????????full,?ï¿½ï¿½ï¿½ï¿½??ï¿½ï¿½????????????????.

			MemoryIndexBackup=MemoryIndex;
			MemoryEndIndexBackup=MemoryEndIndex;

			if(MemoryEndIndex >=1)
			{
				HaveMemoryAvg = 1;
				MemoryClredFlag=0;
				if(!ShowMean && MemoryIndex || HaveMemoryFirst==0) goto NoAverage;	//no display average
			}

            if ((unsigned char)PulseMeanEnd > MAX_PULSERATE)
            {
                DisplayHalfByte(0x11,PulseTen);          /* 'H' */
                DisplayHalfByte(0x12,PulseSingle);          /* 'I' */
                PulseMeanEnd = 0;
            }
            else if((unsigned char)PulseMeanEnd < MIN_PULSERATE)
            {
                DisplayHalfByte(0x13,PulseTen);          /* 'L' */
                DisplayHalfByte(0x14,PulseSingle);          /* 'O' */
                PulseMeanEnd = 0;
            }
            else 	DisplayToPUL((unsigned char)PulseMeanEnd);

			// DisplayToPUL((unsigned char)PulseMeanEnd);
			mmHgKpaDisplay((unsigned char)SysMeanEnd,(unsigned char)DiaMeanEnd);
			MemoryIconOn;					//MR icon display
//			DIAIconOn;SYSIconOn;
			UserABDisplay();
			if(WithWHO==1){ShowWHO(SysMeanEnd,DiaMeanEnd);}//20120317

//			DPDetect(SysMeanEnd,DiaMeanEnd);

			while(!KEY_MEMORYUP||!KEY_TIME);
			delay(8);
			while(!KEY_MEMORYUP||!KEY_TIME);
//*****************************************??????ï¿½ï¿½?
			if(VoiceEnable==1)
				{
					SoundMemoryAVG();
					if(VoiceStop) goto ChangeMemoryIndex2;
				}
		}
//*****************************************??????ï¿½ï¿½?
		else
		{
NoAverage:	HaveMemoryAvg1=0;
			DarkAllIcon();
//			DisplayToPUL(MemoryIndex);	//??????????????X??.

FastChangeLCD:
			DarkAllIcon();
			tomemorykeyinX(MemoryEndIndex);
            if (PulseRam[3].b[0] > MAX_PULSERATE)
            {
                DisplayHalfByte(0x11,PulseTen);          /* 'H' */
                DisplayHalfByte(0x12,PulseSingle);          /* 'I' */
            }
            else if(PulseRam[3].b[0] < MIN_PULSERATE)
            {
                DisplayHalfByte(0x13,PulseTen);          /* 'L' */
                DisplayHalfByte(0x14,PulseSingle);          /* 'O' */
            }
            else 	DisplayToPUL(PulseRam[3].b[0]);
            mmHgKpaDisplay(PulseRam[1].b[0],PulseRam[2].b[0]);
			
			DisplayToMemorySet(MemoryIndexBackup-MemoryIndex+1);	//è®°å¿†æ­£ç¿»1 2 3...
			
			
			
			// DisplayToMemorySet(MemoryIndex);
			UserABDisplay();
			if(!HaveMemoryAvg1 && !NoTimer)
				{ShowMemoryDate(PulseRam[4].b[0],PulseRam[5].b[0]);ShowMemoryTime(PulseRam[6].b[0],PulseRam[7].b[0]);}	//HH:MM

			if(WithWHO==1)
			{ShowWHO(PulseRam[1].b[0],PulseRam[2].b[0]);}	//20101226????WHO????
//			DPDetect(PulseRam[1].b[0],PulseRam[2].b[0]);
			if(PADEnable==1)
				{
					if(PADFlag==1)
						{PADIconOn;PADIconOn1;}
				}
				
			if (CuffDetect)
            {
                CuffIconOn;
                if(CuffOKFlag==1) 		//20221026 add
                {
					CuffIconOff;
                    OKIconOn;
                }
            }
            if (MoveDetect)
            {
                if(MoveFlag == 1)//MoveFlag
                    MoveIconOn;
            }	
						
				if(AFFlag)
				{
					 AFIconOn; 
				}
				else
				{
						AFIconOff;
				}
				
			Last_memory();
			last_memory_flag = 1;
				
//			while(!KEY_MEMORYUP||!KEY_TIME);
//			delay(3);
//*************************??????ï¿½ï¿½?
			if(VoiceEnable==1)
				{
					if(KEY_MEMORYUP)  SoundMemory();	
				}
			
			if(flag_tomemory_long_press==1)
			{
				flag_tomemory_long_press = 0;
				goto ChangeMemoryIndex2;
			}
//*************************??????ï¿½ï¿½?
		}

		AutoOffTimew=0;
		mtemp0c.b=0;
		mtemp1c.b=0;
		SecondFlag = 0;
		while(KEY_POWER)
		{
			while(KEY_MEMORYUP && KEY_TIME && KEY_POWER)
			{
				if(AutoOffTimew>AutoOffTimew_1_S_COUNT * 120) goto TimeOver;//æŸ¥è¯¢è®°å¿†åæ— æ“ä½œè‡ªåŠ¨ç­å±æ—¶é—´ä¸º3åˆ†59ç§’å·¦å³ï¼Œå’Œè§„å®šçš„4åˆ†é’Ÿç­å±åªå·®1ç§’æœ‰ç‚¹å±é™©ï¼Œéœ€è¦è°ƒæ•´ï¼Œæ”¹ä¸º120s
				// if(AutoOffTimew>OFFTIME) goto TimeOver;
			}
//			delay(3);
			// if(!KEY_MEMORYUP || !KEY_POWER||!KEY_TIME) break;
			if(!KEY_MEMORYUP || !KEY_POWER) break;//20230404 bug_check_the_memory_and_press_the_set_button_replay_the_message
		}
ChangeMemoryIndex2:
		if(!KEY_POWER) goto TimeOver;

				if(HaveMemoryFirst==1 && ShowMean==1&&!KEY_MEMORYUP){goto 	NoChangeMemoryIndex;}

				// AutoOffTimew=0;
				if(!KEY_MEMORYUP)
				{
					// while(!KEY_MEMORYUP&&(AutoOffTimew<125));
					// if(AutoOffTimew>124)
					// 	{
					// 		DelOneMemory();
					// 		if(EmptyFlSag)	{EmptyFlag=0;goto Again;}
					// 		HaveMemoryFirst=0;
					// 		goto NextMem;
					// 	}
					
					MemoryIndex--;
					if(MemoryIndex > 250) MemoryIndex = 0;
					MemoryEndIndex--;
					if(MemoryEndIndex > 250) MemoryEndIndex = 0;

					//if(MemoryEndIndex == 0) MemoryEndIndex = MemorySet;
					//if(MemoryIndex == 0) HaveMemoryAvg=0;
					
					if(MemoryFull == 0)
					{
						if(MemoryIndex ==0) MemoryIndex = MemoryIndexBackup;
						if(MemoryEndIndex  ==0) MemoryEndIndex = MemoryEndIndexBackup;
					}
					else
					{
						if(MemoryIndex ==0) MemoryIndex = MemorySet;
						if(MemoryEndIndex  ==0) MemoryEndIndex = MemorySet;
					}
					
					delay(15);
					while(!KEY_MEMORYUP)
					{
							if ( AutoOffTimew >TWO)
							{
								flag_tomemory_long_press=1;
								goto FastChangeLCD;
							}
							else
							{
								flag_tomemory_long_press=0;
								goto FastChangeLCD;
							}
					}
				}

				// if(!KEY_MEMORYUP)
				// 	{
				// 		MemoryIndex++;
				// 		if(MemoryIndex >MemoryIndexBackup) MemoryIndex=1;
				// 		MemoryEndIndex++;
				// 		if(MemoryFull==0)
				// 			{
				// 				if(MemoryEndIndex >MemoryEndIndexBackup) MemoryEndIndex = 1;
				// 			}
				// 		else{if(MemoryEndIndex >MemorySet) MemoryEndIndex = 1;}
				// 	//	if(MemoryEndIndex == 0) MemoryEndIndex = MemorySet;
				// 	//	if(MemoryIndex == 0) HaveMemoryAvg=0;
				// 	}

NoChangeMemoryIndex:
		HaveMemoryFirst=0;  //???????ï¿½ï¿½??????,????????????.
		ShowMean = 0;
		while(!KEY_MEMORYUP ||!KEY_TIME);
		delay(3);
		while(!KEY_MEMORYUP ||!KEY_TIME);
	}
	HaveMemoryAvg=0;

TimeOver:
	DarkAllIcon();
	MemoryMode=0;
	Vioce_LBT_Flag = 0;
}
```

###### 04
```
void totimekeyin(void)
{
	unsigned char i=0;
	IsPowerOn = 1;
	AutoOffTimew = 0;
	UserABDisplay();
	parting_line_off;
	
	CheckBatteryADC();
	delay(2);
	ShowBTBar();
	// while(!KEY_TIME);
	// delay(2);
	// while(!KEY_TIME);
/*
	do									//??mmHg?Kpa??
		{
			mmHgKpaSetDisplay();
			AutoOffTimew = 0;
			do{
				if(AutoOffTimew > OFFTIME){goto ToTimeOver;}
			  }while( KEY_MEMORYUP&& KEY_TIME && KEY_POWER);


					if( !KEY_MEMORYUP)
						{
							if(mmHgkPaFlag==1)
								{
									mmHgkPaFlag=0;
								}
							else{mmHgkPaFlag=1;}
							mmHgKpaSetDisplay();
							while( !KEY_MEMORYUP);
							delay(4);
						}




					if(!KEY_POWER) {IsPowerOn=0; goto ToTimeOver;}


		}while(KEY_TIME);

	while(!KEY_TIME);
	delay(2);
	while(!KEY_TIME);
*/
	
	if(flag_first_power_up == 1)  goto SET_TIME;

	DarkAllIcon();

  ShowBTBar();
	Voice_Display();
goto SET_VOICE;
		do								//??UserA?userB
		{
            while (!KEY_TIME)
            {
                flash_UserAB();
								parting_line_off;
            }
			AutoOffTimew = 0;
			do{
                flash_UserAB();
								parting_line_off;
				if(AutoOffTimew > OFFTIME){goto ToTimeOver;}
			  }
			while( KEY_MEMORYUP&& KEY_TIME && KEY_POWER);


					if(  !KEY_MEMORYUP)
						{
							if(UserA==1)
								{
									UserA=0;
								}
							else{UserA=1;}
							UserABDisplay();
							parting_line_off;
							while(  !KEY_MEMORYUP);
							delay(4);
						}

					if(!KEY_POWER) {IsPowerOn=0; goto ToTimeOver;}
		}while(KEY_TIME);
		Flash_SET_Flag = 0;
SET_TIME:
		
		TimeSetThreeKey();
		

		if(KEY_POWER==0||!IsPowerOn){goto ToTimeOver;}
SET_VOICE:			
		if(VoiceType>NO)
		{
		DarkAllIcon();
		AutoOffTimew = 0;
		ShowVoice();
		while(!KEY_TIME);
		delay(2);
		while(!KEY_TIME);
	ShowBTBar();
	Voice_Display();
		do									//????
			{				
				AutoOffTimew = 0;
				do{
					flash_voiceonoff();
					parting_line_off;
					if(AutoOffTimew > OFFTIME){goto ToTimeOver;}
					}while( KEY_MEMORYUP&& KEY_TIME && KEY_POWER);
			
						if( !KEY_MEMORYUP)
						{
							if(VoiceEnable==1)
							{
								VoiceEnable=0;
							}
							else{VoiceEnable=1;}
							ShowVoice();				
							while(!KEY_MEMORYUP);
							delay(2);
						}
						if(KEY_POWER==0){goto ToTimeOver;}
			}while(KEY_TIME);		

		while(!KEY_TIME);
		delay(4);
		}		

		DarkAllIcon();
		while(!KEY_TIME);
		delay(2);
		while(!KEY_TIME);
	ShowBTBar();
	Voice_Display();
		do									//??mmHg?Kpa??
		{
			mmHgKpaSetDisplay();
			AutoOffTimew = 0;
			do{
				flash_mmghkpa();
				parting_line_off;
				if(AutoOffTimew > OFFTIME){goto ToTimeOver;}
			  }while( KEY_MEMORYUP&& KEY_TIME && KEY_POWER);


					if( !KEY_MEMORYUP)
						{
							if(mmHgkPaFlag==1)
								{
									mmHgkPaFlag=0;
								}
							else{mmHgkPaFlag=1;}
							mmHgKpaSetDisplay();
							while( !KEY_MEMORYUP);
							delay(4);
						}
					if(!KEY_POWER) {IsPowerOn=0; goto ToTimeOver;}
		}while(KEY_TIME);

//************************************************????????
/*
		AutoOffTimew = 0;
		DarkAllIcon();
		do{
				DisplayHalfByte(0x0c,DIATen);		// 'C'
	    	DisplayHalfByte(0x13,DIASingle);	// 'L'
	    	if(AutoOffTimew > OFFTIME){goto ToTimeOver;}
	    	delay(2);
	    	}while(KEY_POWER&&KEY_TIME);
		if(!KEY_POWER)
			{
				CLRMemoryBank();
				flashCL();		//CL flash
			}
		while(!KEY_TIME);
		delay(4);
*/
ToTimeOver:
		IsPowerOn=0;
		DarkAllIcon();
		for(i=0;i<3;i++)
			{
				EEPROMin = 0xFB+i;
				readM24L16();
				outbyte[0]=inbyte[0];
				outbyte[1]=inbyte[1];
				outbyte[2]=inbyte[2];
				if(mmHgkPaFlag==1){outbyte[3]=inbyte[3]|0x01;}
				else{outbyte[3]=inbyte[3]&0xfe;}

				if(UserA==1){outbyte[4]=inbyte[4]|0x08;}
				else{outbyte[4]=inbyte[4]&0xf7;}

				if(VoiceEnable) outbyte[4]=outbyte[4]|0x10;
				else outbyte[4]=outbyte[4]&0xEF;

				outbyte[5]=volume_value; //save volume
				outbyte[6]=inbyte[6]; //NC
				writeM24L16();
			}
}
```

###### 05
```
//if(MemoryIndex == 0) HaveMemoryAvg=0;  //ç´¢å¼•è¶Šç•Œåé‡æ–°ç´¢å¼•,å¹¶åœç•™åœ¨æ¾å¼€æŒ‰é”®æ—¶ç´¢å¼•çš„è®°å¿†ä½ç½®;å–æ¶ˆæ³¨é‡Šåˆ™è¶Šç•Œååœç•™åœ¨ç¬¬1ç¬”è®°å¿†
```

##### AXD-303 A é›¾åŒ–å™¨
AXD-303 A éœ€è¦æ·»åŠ èœ‚é¸£å™¨åŠŸèƒ½ã€‚
2025 å¹´ 10 æœˆ 30 æ—¥æ™šä¸Šï¼Œå¤–æ¥èœ‚é¸£å™¨å°è¯•èƒ½ä¸èƒ½ç›´æ¥æ¥ IO å£æ§åˆ¶ã€‚5 V æ— æºèœ‚é¸£å™¨ï¼Œåœ¨è½¯ä»¶æ¨¡æ‹Ÿè¾“å‡º PWM æ–¹æ³¢ï¼ˆ2.5 KHzï¼Œ57%å ç©ºæ¯”ï¼‰å¯ä»¥å®ç°èœ‚é¸£ã€‚
![[../../annex/16.å…¥èŒç¬¬åå…­å‘¨10.27-11.1(å•ä¼‘)_image_11.png]]
ä¸€å¼€å§‹ä¸å“çˆ±é‚£ä¸ªï¼Œæ˜¯ä»£ç é—®é¢˜ï¼Œå¤–æ¥å°ç”µæºå°è¯•ä¾›ç”µå‘ç°ï¼Œèœ‚é¸£å™¨ 2.7 V å°±å¼€å§‹æœ‰å“å£°ï¼Œéšç€ç”µå‹å¢å¤§è€Œå“åº¦å¢å¤§ã€‚ï¼ˆ2.6 V ä¸å“ï¼‰
å³ï¼Œ5 V èœ‚é¸£å™¨æœ€ä½å·¥ä½œç”µå‹ä¸º 2.7 Vï¼Œ3.6 V å“åº¦ä¹Ÿè¿˜å¯ä»¥ã€‚


AXD-303Aï¼Œé”¦é”ï¼ŒèŠ¯ç‰‡å¼•è„šå›¾
![[../../annex/16.å…¥èŒç¬¬åå…­å‘¨10.27-11.1(å•ä¼‘)_image_12.png]]

![[../../annex/16.å…¥èŒç¬¬åå…­å‘¨10.27-11.1(å•ä¼‘)_image_13.png]]

##### æ™¶åå¾®ä»¿çœŸå™¨/çƒ§å½•å™¨æ¥çº¿

æ™¶åå¾®çƒ§å½•å™¨ï¼š
1 pin--BOOT
4 pin--GND
5 pin--SDA (SCLK)
6 pin--SCL (SDIO)
7 pin--VDD
æ¥çº¿ï¼š
GND-GND
SW (SCLK)--SDA
SCL (SDIO)--SCL
VDD-VM

![[../../annex/16.å…¥èŒç¬¬åå…­å‘¨10.27-11.1(å•ä¼‘)_image_14.png]]

![[../../annex/16.å…¥èŒç¬¬åå…­å‘¨10.27-11.1(å•ä¼‘)_image_15.png]]


##### PCM 01


![[../../annex/16.å…¥èŒç¬¬åå…­å‘¨10.27-11.1(å•ä¼‘)_image_16.png]]
```æµ‹è¯•
while(1)
{
		if(!KEY_POWER) heating_icon_on;
		if(!KEY_MEMORYUP) avg_icon_on;
		if(!KEY_ECO)	time_icon_on;
}
```


##### é”‚ç”µæ± ä¸Šç”µèƒŒå…‰ä¼šé—ªä¸€ä¸‹ï¼Œæ¢ä¸»æ§è§£å†³--BP00A

##### å°ç±³å……ç”µå™¨ä¾›ç”µä¼šï¼ˆä¸Šç”µæ—¶ï¼‰ä¼šæœ‰çº¦1ç§’é’Ÿçš„æ‹‰ä½ç”µå¹³ï¼ˆæ‰ç”µï¼‰ã€‚

![[../../annex/16.å…¥èŒç¬¬åå…­å‘¨10.27-11.1(å•ä¼‘)_image_17.jpg]]
ä½¿ç”¨å°ç±³å……ç”µå™¨æœ‰å‡ ç‡æ‰ç”µ1ç§’å·¦å³ã€‚
å¯èƒ½æ˜¯ 16 pin çš„ Type-Cï¼Œå…¶ä¸­é€šè®¯å¼•è„šè¢«é…ç½®æˆäº†è‡ªåŠ¨å·¥è£…ï¼Œå¯èƒ½æ˜¯è·Ÿå°ç±³å……ç”µå™¨çš„å¼•è„šæœ‰æ‰€å†²çªè€Œå¼•èµ·çš„ï¼ˆæœ‰ 2 ä¸ªå¼•è„šç”µå¹³å½±å“åˆ°äº†ï¼‰ã€‚
ä½¿ç”¨ 6 pin è¿˜æ˜¯ 7 pin  ï¼ˆä¸å¸¦æ•°æ®ä¼ è¾“ï¼‰çš„å……ç”µå™¨åˆ™æ­£å¸¸ã€‚åä¸ºçš„å……ç”µå™¨ä¹Ÿæ­£å¸¸ã€‚


!![[../../annex/16.å…¥èŒç¬¬åå…­å‘¨10.27-11.1(å•ä¼‘)_image_18.jpg]]


##### èŠå¤©ç¾¤èŠ
![[../../annex/16.å…¥èŒç¬¬åå…­å‘¨10.27-11.1(å•ä¼‘)_image_19.png]]
1.â‘ è¿™ä¸ªå°±æ˜¯è‡ªåŠ¨å·¥è£…ï¼Ÿ

2.â‘¡è‡ªåŠ¨å·¥è£…æ˜¯ç”¨ä¸²å£ï¼Œè¦æ˜¯ç¡¬ä»¶ä¸²å£æœ‰çš„å¤šå°±ç”¨ç¡¬ä»¶ä¸²å£ï¼Œç¡¬ä»¶ä¸²å£ä¸å¤Ÿç”¨å°±ç”¨æ¨¡æ‹Ÿä¸²å£

3.â‘ æˆ‘è¿˜ä»¥ä¸ºè¿™ä¸ªæ˜¯è‡ªåŠ¨å·¥è£…å‘¢ã€‚åŸæ¥æ˜¯ USB çƒ§å½•çš„ VMã€‚æˆ‘çœ‹å…¶ä»–çš„éƒ½æ˜¯å•ç‹¬å†å¼•ä¸€ä¸ª VM å‡ºæ¥ã€‚

![[../../annex/16.å…¥èŒç¬¬åå…­å‘¨10.27-11.1(å•ä¼‘)_image_20.png]]
4.â‘¡â†‘è¿™é‡Œçš„ SCL å’Œ SWAT åº”è¯¥æ˜¯ç•™ç»™è‡ªåŠ¨å·¥è£…çš„

##### PCM 02

![[../../annex/16.å…¥èŒç¬¬åå…­å‘¨10.27-11.1(å•ä¼‘)_image_21.png]]

PCM01ä¸è¡¥æ°”ã€‚ADC æœ‰æ”¹å˜ã€‚
![[../../annex/16.å…¥èŒç¬¬åå…­å‘¨10.27-11.1(å•ä¼‘)_image_22.png]]

Auto_Wakeup


```
if(show_cnt >= horse_race_lap_time)
		{
			show_cnt = 0;
			horse_lap_cnt++;
			if(horse_lap_cnt > 2/*3*/) horse_lap_cnt = 0;
		}
		show_horse_race_lap_feel(horse_lap_cnt);
```


```
void show_horse_race_lap_feel(uint8 cnt)
{
	Cushion_icon_on;
	DogSleep_icon_on;
	if(cnt == 0) {/*RELIEF_icon_on;BALANCE_icon_off;SUPPORT_icon_off;*/LIGHT_icon_on;RESTFUL_icon_off;WELL_icon_off;};
	if(cnt == 1) {/*RELIEF_icon_on;BALANCE_icon_on;SUPPORT_icon_off;*/LIGHT_icon_on;RESTFUL_icon_on;WELL_icon_off;};
	if(cnt == 2) {/*RELIEF_icon_on;BALANCE_icon_on;SUPPORT_icon_on;*/LIGHT_icon_on;RESTFUL_icon_on;WELL_icon_on;};
	//if(cnt == 3) {/*RELIEF_icon_on;BALANCE_icon_on;SUPPORT_icon_on;*/LIGHT_icon_off;RESTFUL_icon_off;WELL_icon_off;}
	if(cnt==0 /*|| cnt==2*/)
	{
		if(cushion_state == 0)
		{
			RELIEF_icon_on;BALANCE_icon_off;SUPPORT_icon_off;
		}
		else if(cushion_state == 1)
		{
			RELIEF_icon_off;BALANCE_icon_on;SUPPORT_icon_off;
		}
		else if(cushion_state == 2)
		{
			RELIEF_icon_off;BALANCE_icon_off;SUPPORT_icon_on;
		}
	}
	else
	{
		RELIEF_icon_off;BALANCE_icon_off;SUPPORT_icon_off;
	}
}
```


```
void show_horse_race_lap_feel(uint8 cnt)
{
	Cushion_icon_on;
	DogSleep_icon_on;
	if(cnt == 0) {RELIEF_icon_on;BALANCE_icon_off;SUPPORT_icon_off;LIGHT_icon_on;RESTFUL_icon_off;WELL_icon_off;};
	if(cnt == 1) {RELIEF_icon_on;BALANCE_icon_on;SUPPORT_icon_off;LIGHT_icon_on;RESTFUL_icon_on;WELL_icon_off;};
	if(cnt == 2) {RELIEF_icon_on;BALANCE_icon_on;SUPPORT_icon_on;LIGHT_icon_on;RESTFUL_icon_on;WELL_icon_on;};
	//if(cnt == 3) {/*RELIEF_icon_on;BALANCE_icon_on;SUPPORT_icon_on;*/LIGHT_icon_off;RESTFUL_icon_off;WELL_icon_off;}
	/*if(cnt==0)	// || cnt==2
	{
		if(cushion_state == 0)
		{
			RELIEF_icon_on;BALANCE_icon_off;SUPPORT_icon_off;
		}
		else if(cushion_state == 1)
		{
			RELIEF_icon_off;BALANCE_icon_on;SUPPORT_icon_off;
		}
		else if(cushion_state == 2)
		{
			RELIEF_icon_off;BALANCE_icon_off;SUPPORT_icon_on;
		}
	}
	else
	{
		RELIEF_icon_off;BALANCE_icon_off;SUPPORT_icon_off;
	}*/
}
```


```
ShowFeel(cushion_state/*day_avg_result_data.motion_mark*/);
```


```
#if	0				
			if (KEY_MEMORYUP==0)
			{
				MEMMODE:
				while (KEY_MEMORYUP==0);
				DarkAllIcon();
				delay(4);
				DayAvgMode();
				WorkMode=1;
				while (KEY_MEMORYUP==0);
				DarkAllIcon();
				WorkMode=1;
				AutoOffTimew=0;
				if(lowbat_flag == 1){goto end;}
				g_state = STATE_STANDBY;
				UART_Init();
				no_detect_move_count = 500;
			}
			break;

			case STATE_SLEEP:  
			ShowLight();
			disp_cushion_state(cushion_state);
			disp_to_temp(lasttemp);
			if (movement_state==1)
			{
				AutoOffTimew = 0;
				DarkAllIcon();
				g_state = STATE_Measure;
			}
			

			break;
		case STATE_Measure:
		if (movement_state == 1)
		{
			show_cnt++;
			if (show_cnt>=display_switch_time)
			{
				show_cnt =0;
				switch (led_cnt)
				{
				case 0:
					rolls_icon_on;
					break;
				case 1:
					rolls_icon_off;
					break;
				case 2:
					rolls_icon_on;
					break;
				case 3:
					rolls_icon_off;
					break;	
				default:
					break;
				}
				led_cnt+=1;
				if (led_cnt>3)
				{
					led_cnt =0;
				}
			}

		}else
		{
			AutoOffTimew = 0;
			DarkAllIcon();
			g_state = STATE_SLEEP;
		}

		break;

		case STATE_Auto_Monitoring:   
		{
			if (BedFlag == 1)
			{
				Auto_Wakeup = 0;
				goto reset;
			}
			
			if (AutoOffTimew>offtime_5s*6) 
			{
				goto end;
			}
		}
	
		default:
		break;
		}
		
		
	} while (1);
#endif
```


##### ç”µæ± ç”µé‡ç™¾åˆ†æ¯”æ˜¾ç¤ºé—®é¢˜

æµ‹é‡æ•°æ®ï¼š
![[../../annex/16.å…¥èŒç¬¬åå…­å‘¨10.27-11.1(å•ä¼‘)_image_23.png]]
â†“å¯¹åº”æ ·æœºï¼š
![[../../annex/16.å…¥èŒç¬¬åå…­å‘¨10.27-11.1(å•ä¼‘)_image_24.jpg]]




![[../../annex/16.å…¥èŒç¬¬åå…­å‘¨10.27-11.1(å•ä¼‘)_image_25.jpg]]


```
>4.1 Vï¼Œ99%
3.5 V<ï¼Œ1%
åªåœ¨å¼€æœºæ—¶æ£€æµ‹ç”µå‹
æ»¡ç”µé€šè¿‡FULLè„šï¼ˆå……ç”µç®¡ç†ICçš„pinè„šï¼‰ç”µå¹³çŠ¶æ€æ¥åˆ¤æ–­æ˜¯å¦æ»¡ç”µ
ä½ç”µé€šè¿‡æ¯”è¾ƒå™¨æ¥åˆ¤æ–­ä½ç”µ

é—®é¢˜æ¯”è¾ƒå¤§çš„æ˜¯æœ‰æ»¡ç”µæç¤ºLEDç¯çš„æƒ…å†µã€‚

```





##### æ€»ç»“
1ã€é‡åˆ°å¦‚ P106Cã€P126Cã€P136C ä¹‹ç±»çš„å……ç”µç®¡ç†é—®é¢˜ã€‚å¦‚é‡åˆ°é—ªå±ã€å…ˆè€ƒè™‘è½¯ä»¶é—®é¢˜ã€‚
 â‘ ç¡¬ä»¶é—®é¢˜ä¸Šè¿˜éœ€è¦è€ƒè™‘ä¸€ä¸ªç‚¹ï¼šä¼šä¸ä¼šæ˜¯å¹²/é”‚ç”µæ± ä¸è¡Œï¼Œæ›´æ¢ä¸ªç”µæ± è¯•ä¸€ä¸‹ã€‚å¦‚æœæœ‰ 2 å°æœºå™¨ï¼Œçœ‹çœ‹å¦å¤–ä¸€å°æœºå™¨æœ‰æ²¡æœ‰ç›¸åŒé—®é¢˜ï¼Œå¦‚æœåªæœ‰ä¸€å°æœºå™¨æœ‰æŸä¸ªé—®é¢˜ï¼Œåˆ™å°è¯•äº’æ¢ç”µæ± çœ‹çœ‹ç°è±¡ã€‚
 â‘¡æŠ“å¼‚å¸¸ç°è±¡æ—¶çš„æ³¢å½¢ï¼ŒæŸ¥çœ‹ä¸Šç”µã€å¼€æœºåˆ†åˆ«çš„ç”µå‹æƒ…å†µï¼Œæ˜¯ä½ç”µå¹³è¿˜æ˜¯é«˜ç”µå¹³ï¼Œåˆ‡æ¢è¿‡ç¨‹ä¸­æœ‰æ²¡æœ‰å¼‚å¸¸æ³¢å½¢ã€‚
 â‘¢å¦‚æœè¦æ›´æ¢å…ƒå™¨ä»¶ï¼Œéœ€è¦è·Ÿç¡¬ä»¶è¯´ä¸€å£°ï¼Œå°¤å…¶æ˜¯å¦‚æœæ›´æ¢æˆäº†ä¸åŒå‹å·çš„å…ƒå™¨ä»¶

2ã€æ–¹ç¿”äº‘æ¢å±ä»»åŠ¡å‘ç° LCD å±å‡ºç°ç»™ SEG è„šå‰åŠéƒ¨åˆ† 0 XFFï¼Œå‡ºç°ç‚¹äº®ä¸ŠåŠéƒ¨åˆ†æ˜¾ç¤ºã€ç»™ SEG è„šååŠéƒ¨åˆ† 0xFFï¼Œç‚¹äº®ä¸‹åŠéƒ¨åˆ†ï¼Œå¦‚æœå…¨éƒ¨ç½® 0xFFï¼Œå‡ºç°ä¸‹åŠéƒ¨åˆ†è¢«ç†„ç­ã€åªæœ‰ä¸ŠåŠéƒ¨åˆ†å¯ä»¥æ˜¾ç¤ºçš„é—®é¢˜ã€‚
--æ˜¯ LCD å±æ¥çº¿æ¥é”™äº†ï¼ŒSEG å’Œ COM çš„çº¿æ¥åäº†ã€‚





### å·¥ä½œä¹‹ä½™

ç»å¤§éƒ¨åˆ† PCB æ¿ç”¨çš„æ˜¯ç»ç’ƒçº¤ç»´, ç†”ç‚¹åœ¨ 700 åº¦ï¼Œç„Šé”¡é€šå¸¸åœ¨ 300 åº¦
â€œæ— é”¡ç„Šé“…â€œçš„æ¸©åº¦ä¸åˆ° 200 åº¦ï¼Œ
æ— é“…çš„ä¸€èˆ¬æ¸©åº¦ä¼šæ›´é«˜ï¼Œä¸€èˆ¬é“…è¶Šå¤šæ¸©åº¦è¶Šä½ï¼Œå¥½ç”¨ä½†æ˜¯å¯¹èº«ä½“ä¸å¥½ã€‚

å·¥ç¨‹å¡‘æ–™è½¯åŒ–è¦250åº¦ä»¥ä¸Šé«˜æ¸©é”¡ç†”ç‚¹åœ¨250åº¦åˆ°217ä¹‹é—´æ•´æ¿å‡åŒ€åŠ çƒ­åˆ°230å°±å¤Ÿç„Šäº†ï¼Œå±€éƒ¨åŠ çƒ­è¦çƒ™é“300å¤šåº¦è¿™æ—¶è¦æ§åˆ¶æ¥è§¦æ—¶é—´ã€‚ä¸èƒ½é•¿æ—¶é—´ç„Šä¸€ä¸ªç‚¹

é’¢ç½‘ä¸Šé”¡åæ”¾ä¸Šå…ƒå™¨ä»¶ï¼ŒåŠ çƒ­èåŒ–é”¡è¾¾åˆ°ç„Šæ¥ç›®çš„ã€‚ç”¨é“æ¿çƒ§ï¼Œç”¨é£æªçš„è¯å…ƒä»¶ä¼šæœ‰ä½ç§»ï¼ˆå¹è·‘å…ƒä»¶ï¼‰
é€šè¿‡ç„Šæ²¹å’Œç„Šé”¡çš„è¡¨é¢å¼ åŠ›æ¥å®ç°é”¡æµ†èåŒ–åè®©å…ƒå™¨ä»¶å¯¹å‡†ã€‚



|    å…ƒå™¨ä»¶ç±»åˆ«     |         å…·ä½“å‹å·/å°è£…          | æ¨èç„Šæ¥æ¸©åº¦èŒƒå›´ |    æœ€å¤§è€å—æ¸©åº¦/æ—¶é—´    |          å…³é”®æ³¨æ„äº‹é¡¹          |
|:-----------------:|:------------------------------:|:----------------:|:-----------------------:|:------------------------------:|
|  IC èŠ¯ç‰‡ (é€šç”¨)   |      SOP/SSOP/QFP ç­‰å°è£…       |    300â„ƒ-350â„ƒ     | 260â„ƒ,10 ç§’; 350 â„ƒ, 3 ç§’ |    ä¸¥æ ¼æ§æ—¶ï¼Œå»ºè®®ä½¿ç”¨çƒ­é£æª    |
|    å……ç”µç®¡ç† IC    |       CN 3791 (SSOP 10)        |        -         |       260â„ƒ, 10 ç§’       |          å‚é˜…æ•°æ®æ‰‹å†Œ          |
|     ç”µé˜»/ç”µå®¹     |         0603/0402 å°è£…         |    350 â„ƒå·¦å³     |          265 â„ƒ          |    ä½“ç§¯å°, æ•£çƒ­å¿«, é€Ÿæˆ˜é€Ÿå†³    |
|     è´´ç‰‡ç”µå®¹      |           0402 å°è£…            |        -         |     270Â±5 â„ƒ, 10 ç§’      |   å¯¹æ¸©åº¦æ•æ„Ÿï¼Œè¿‡çƒ­æ˜“æŸåä»‹è´¨   |     |     |     |     |     |     |
| è´´ç‰‡äºŒæç®¡/æ™¶ä½“ç®¡ |  äºŒæç®¡ï¼ˆSODï¼‰ã€ä¸‰æç®¡ï¼ˆSOTï¼‰  |    350-400 â„ƒ     |            -            | ç„Šæ¥æ—¶é—´ä¸å®œè¿‡é•¿, é˜²æ­¢è¿‡çƒ­æŸå |     |     |     |     |     |     |
|     è´´ç‰‡ LED      |       å¸¸è§è´´ç‰‡ LED ç¯ç         |    260-300 â„ƒ     |     295Â±5â„ƒ, 3 ç§’å†…      |           å¯¹é«˜æ¸©æ•æ„Ÿ           |     |     |     |     |     |     |
|      MOS ç®¡       | SOT-23 å°è£…ï¼ˆå¦‚ HM 3400 C-VBï¼‰ |        -         |    260â„ƒ, 5 ç§’æˆ– 300â„ƒ    |       å¤§åŠŸç‡å™¨ä»¶æ³¨æ„æ•£çƒ­       |     |     |     |     |     |     |
|    è´´ç‰‡èœ‚é¸£å™¨     |        å‹ç”µå¼æ— æºèœ‚é¸£å™¨        |        -         |   320-350â„ƒ, 0.5-2 ç§’    |         é¿å…é•¿æ—¶é—´åŠ çƒ­         |     |     |     |     |     |     |
|                   |                                |                  |                         |                                |     |     |     |     |     |     |


```

è´´ç‰‡å…ƒä»¶çš„ç„Šæ¥ç¡®å®æ˜¯ä¸ªç²¾ç»†æ´»ï¼Œæ¸©åº¦å’Œæ—¶é—´æ§åˆ¶æ˜¯å…³é”®ã€‚ä¸‹é¢æˆ‘æ±‡æ€»äº†ä¸€ä¸ªè¡¨æ ¼ï¼Œå¸®ä½ å¿«é€Ÿäº†è§£å¸¸è§å…ƒä»¶çš„ç„Šæ¥å‚æ•°ï¼Œä¹‹åæˆ‘ä»¬å†è¯¦ç»†èŠèŠå…·ä½“çš„æŠ€å·§å’Œæ³¨æ„äº‹é¡¹ã€‚

 ğŸ” å¸¸è§è´´ç‰‡å…ƒå™¨ä»¶ç„Šæ¥å‚æ•°é€ŸæŸ¥è¡¨ 

 ğŸ”¥ é€šç”¨ç„Šæ¥åŸåˆ™ä¸æ ¸å¿ƒæŠ€å·§

æ— è®ºç„Šæ¥å“ªç§å…ƒä»¶ï¼ŒæŒæ¡ä»¥ä¸‹åŸåˆ™èƒ½è®©ä½ äº‹åŠåŠŸå€ï¼š

- æ¸©åº¦ä¸æ—¶é—´çš„å¹³è¡¡ï¼šç„Šæ¥çš„æœ¬è´¨æ˜¯åœ¨çƒ­é‡ã€æ—¶é—´ä¹‹é—´å–å¾—å¹³è¡¡ã€‚ç›®æ ‡æ˜¯è®©ç„Šé”¡å……åˆ†ç†”åŒ–å¹¶å½¢æˆè‰¯å¥½ç„Šç‚¹ï¼ŒåŒæ—¶é¿å…å…ƒå™¨ä»¶å’ŒPCBæ¿è¿‡çƒ­ã€‚é€šå¸¸ï¼Œæ¯ä¸ªç„Šç‚¹çš„æ“ä½œæ—¶é—´åº”æ§åˆ¶åœ¨3ç§’ä»¥å†…ã€‚
- å·¥å…·é€‰æ‹©ä¸è®¾ç½®ï¼š
    - ç”µçƒ™é“ï¼šä¼˜å…ˆé€‰ç”¨å¯è°ƒæ¸©ã€å¸¦æ¥åœ°çš„æ’æ¸©çƒ™é“ã€‚ç„Šæ¥ç²¾å¯†è´´ç‰‡å…ƒä»¶ï¼Œæ¸©åº¦èŒƒå›´é€šå¸¸åœ¨300Â°Cåˆ°400Â°Cä¹‹é—´è°ƒæ•´ã€‚å°–å˜´æˆ–åˆ€å¤´çƒ™é“å¤´æ›´é€‚åˆç²¾ç»†æ“ä½œã€‚
    - çƒ­é£æªï¼šé€‚åˆå¤šå¼•è„šICç„Šæ¥ã€‚å¯¹äºæœ‰é“…ç„Šé”¡ï¼Œæ¸©åº¦å¯è®¾330-350Â°Cï¼›æ— é“…ç„Šé”¡ä¸º350-370Â°Cã€‚é£é€Ÿé€‰æ‹©ï¼šè´´ç‰‡é˜»å®¹ä»¶ç”¨2-3æ¡£ï¼ŒICç±»ç”¨3-4æ¡£ã€‚
- æ‰‹æ³•å…³é”®ï¼š
    - å¿«å’Œå‡†ï¼šå‡å°‘çƒ™é“ä¸ç„Šç‚¹æ¥è§¦æ—¶é—´ã€‚
    - ä½¿ç”¨ç„Šé”¡ä¸ï¼šç„Šé”¡ä¸èƒ½å¸®åŠ©çƒ­é‡å¿«é€Ÿä¼ é€’ã€‚
    - è¾…åŠ©æ•£çƒ­ï¼šç”¨é•Šå­è½»å¤¹å…ƒä»¶å¼•è„šå¸®åŠ©æ•£çƒ­ï¼ˆæ³¨æ„é¿å…çŸ­è·¯ï¼‰ã€‚
- è§‚å¯Ÿç„Šç‚¹çŠ¶æ€ï¼šè‰¯å¥½ç„Šç‚¹åº”å…‰æ»‘ã€æ˜äº®ï¼Œå‘ˆåœ†é”¥å½¢ï¼Œç„Šé”¡èƒ½å¾ˆå¥½åœ°æ¶¦æ¹¿ç„Šç›˜å’Œå…ƒä»¶å¼•è„šã€‚

 âš ï¸ é‡è¦æ³¨æ„äº‹é¡¹

1.  é¢„é˜²é™ç”µæŸä¼¤ï¼šMOSç®¡ã€ICç­‰å…ƒä»¶å¯¹é™ç”µæ•æ„Ÿã€‚æ“ä½œæ—¶éœ€ä½©æˆ´é˜²é™ç”µæ‰‹ç¯ï¼Œä½¿ç”¨é˜²é™ç”µå·¥ä½œå°å’Œçƒ™é“ã€‚
2.  é¿å…çƒ­åº”åŠ›å†²å‡»ï¼šæ€¥å‰§æ¸©åº¦å˜åŒ–å¯èƒ½å¯¼è‡´å…ƒä»¶å†…éƒ¨å¼€è£‚ã€‚è®©ç„Šç‚¹è‡ªç„¶å†·å´ï¼Œé¿å…ç”¨å˜´å¹æ°”å¼ºåˆ¶å†·å´ã€‚
3.  è­¦æƒ•è™šç„Šå’Œè¿é”¡ï¼š
    - è™šç„Šï¼šé€šå¸¸å› æ¸©åº¦ä¸è¶³ã€ç„Šæ¥æ—¶é—´ä¸å¤Ÿæˆ–ç„Šç›˜æ°§åŒ–å¯¼è‡´ã€‚
    - è¿é”¡ï¼ˆæ¡¥æ¥ï¼‰ï¼šå¤šå¼•è„šICå¸¸è§é—®é¢˜ã€‚å¯å€ŸåŠ©çƒ™é“åˆ©ç”¨è¡¨é¢å¼ åŠ›æ‹–æ›³å¤šä½™ç„Šé”¡ï¼Œæˆ–ä½¿ç”¨å¸é”¡çº¿ã€‚
4.  å–„ç”¨åŠ©ç„Šå‰‚ï¼šåŠ©ç„Šå‰‚èƒ½å»é™¤æ°§åŒ–ç‰©ï¼Œæé«˜ç„Šé”¡æµåŠ¨æ€§ã€‚å¯¹äºéš¾ä¸Šé”¡ç„Šç‚¹ï¼Œé€‚é‡æ·»åŠ åŠ©ç„Šå‰‚æ•ˆæœæ˜¾è‘—ã€‚

 ğŸ’ æ€»ç»“ä¸æ ¸å¿ƒå»ºè®®

æˆåŠŸç„Šæ¥è´´ç‰‡å…ƒä»¶çš„æ ¸å¿ƒåœ¨äºï¼šä¸ºç‰¹å®šå…ƒä»¶é€‰æ‹©åˆé€‚çš„æ¸©åº¦ã€ä½¿ç”¨åˆé€‚çš„å·¥å…·ã€é‡‡ç”¨æ­£ç¡®çš„æ‰‹æ³•ï¼Œå¹¶ä¸¥æ ¼æ§åˆ¶åŠ çƒ­æ—¶é—´ã€‚

æœ€å¯é çš„å‚æ•°æ¥æºæ°¸è¿œæ˜¯å…ƒå™¨ä»¶çš„æ•°æ®æ‰‹å†Œã€‚å¸Œæœ›è¿™äº›ä¿¡æ¯èƒ½å¸®åŠ©ä½ æ›´è‡ªä¿¡åœ°å®Œæˆç„Šæ¥å·¥ä½œï¼å¦‚æœä½ åœ¨ç„Šæ¥æŸä¸ªç‰¹å®šå…ƒä»¶æ—¶é‡åˆ°äº†æ£˜æ‰‹çš„é—®é¢˜ï¼Œæ¬¢è¿éšæ—¶å†æ¥é—®æˆ‘ã€‚
```

















































































































