

##### AXD -846 E
![[../../annex/17.入职第十七周11.3-11.7(双休)_image_1.png]]

使用双头 Tpye-c 数据线，连接电脑按键无反应-------
解决方式：TUDETECT 函数没有添加按键跳出的条件。

```
void TUDetect(void)
{
    AutoOffTimew = 0;
    while (1)
    {
        res = simulate_uart_get_buff_server(&stru_cmd_decode);
        if (res == 1)
        {
            if (checke_cmd_ack(E_CMD_START_COMMAND) == 1)
            {
                send_ack_cmd(E_CMD_START_COMMAND);
                AutoTestMode(); // ½øÈë×Ô¶¯²âÊÔº¯Êý
                break;
            }
        }
        else if (res == 0)
        {
        }

        if (AutoOffTimew > AutoOffTimew_1_S_COUNT * 3)
        {
            AutoOffTimew = 0;
            break;
        }

				if(!KEY_POWER || !KEY_MEMORYUP || !KEY_MEMORYDOWN || !KEY_TIME)
				{
					AutoOffTimew = 0;
          break;
				}
    }
    flag_is_auto_test_run = 0;
}
```



第三个引脚，与 GND 之间的电压为2.54V
6pin-Type-C，外面2个引脚为 GND，第2个和倒数第2个引脚为 VCC（对称）
中间两个为识别引脚，通常接5.1K 电阻。
遇到120W 不供电的情况，把中间2个引脚接 GND（可以先短接上一坨锡，然后再飞线出来接 GND）。看能不能供电。

Vcc 与 GND，5.02V
GND 与 D+，1.71V
AXD-846 E，120 W 小米充电器，机器无反应无电压时，GND 与 D+2.54V。
Vcc 与 D+，0V
Vcc 与 D-，3.3V
5.02 V


##### AXD-840 E--锂电

&& bar_val!=7 （血压偏低时，改为不播报“若连续几天都维持这数值,请恰询您的医师”）


需要实现插入 USB: Type-C、不接锂电池时，全部功能正常使用（设置键、记忆键、测量键都可正常使用）。
而插入 USB: Type-C、且接锂电池时，只能进行设置和查看记忆，不能进入测量。

FULL 引脚和 CHARGE 引脚的不同电平状态分别代表不同的电源状态。

| FULL/Full 引脚 | CHARGE/Charge 引脚 |                 电源状态判断                  |    结构体标识变量    |                 注意/说明                 |
|:--------------:|:------------------:|:---------------------------------------------:|:--------------------:|:-----------------------------------------:|
|       1        |         1          |          空闲未充电（只接了锂电池）           |       NOCHARGE       |                                           |
|       1        |         0          |    FUll 脚高电平, 满电（接了锂电池和 USB）    |       FULL_BAT       |                                           |
|       0        |         1          | Charge 脚高电平, 正在充电（接了锂电池和 USB） |       CHARGING       |                                           |
|       0        |         0          |                       -                       |                      |                                           |
|       -        |        翻转        |   Charge 引脚间隔 2 ms 翻转电平（只接 USB）   | NO_BAT_AND_USB_INPUT | FULL 引脚和 Charge 引脚间隔 2 ms 翻转电平 |


```
//低电压触发阈值
#define LOW_BAT_VAL ((g_s_func.e_power_type == DRY_BAT) ? ((uint32_t)420) : ((uint32_t)340))

typedef enum
{
    NO_CHARGE = 0,//没有充电 空闲
    CHARGING,//正在充电
    FULL_BAT,// 充满
    NO_BAT_AND_USB_INPUT,//没有锂电但usb供电插入, 此时charge pin会一直翻转(2ms周期)
}e_charge_stat_t;
```


![[../../annex/17.入职第十七周11.3-11.7(双休)_image_2.png]]

方少，这俩引脚的状态分别是咋样的？

Full 引脚未满电的时候是 0，满电置 1；
Charge 引脚充电的时候是 0，未插入 type-c 充电的时候是1吗？
充电 IC 不一样状态可能也不一样

未插入空闲引脚都是高，充电和充满一高一低，没电池就是一直翻转

![[../../annex/17.入职第十七周11.3-11.7(双休)_image_3.png]]

定时器中去检测有无插入 USB 充电、有无接锂电池，容易出现漏判断的情况。
而在代码中直接加入固定死循环 500 ms 去判断的话可靠性更高

![[../../annex/17.入职第十七周11.3-11.7(双休)_image_4.png]]
进入测量，播报了个“请保持安静，现在准备开始测量血压...”中的“请”字后，立马中断，并进行播报“电力不足”→语音 ic 的 pin1悬空引脚接了 GND（原本是 pin 2 接 GND, 飞线搞错了就这样播报了）


##### 3 .05V--松瀚仿真器仿真器的工作电压

##### U80I 换屏

```
//	writeFULLmemorybank();

	while(1)
	{
		//DisplayToPUL(test1);
		//DisplayHalfByte(test1,test2);
//		WHOLevel1Icon;
//		delay(100);
//		WHOLevel2Icon;delay(100);
//		WHOLevel3Icon;delay(100);
//		WHOLevel4Icon;delay(100);
//		WHOLevel5Icon;delay(100);
//		WHOLevel6Icon;delay(100);
//		DarkAllIcon();delay(100);
		
//		SoundAllCommand2(0x55,1,0,0);	//optimal
//		delay(100);
//		SoundAllCommand2(0x55,2,0,0);	//normal
//		delay(100);
//		SoundAllCommand2(0x55,3,0,0);	//High normal
//		delay(100);
//		SoundAllCommand2(0x55,4,0,0);	//mild hypertension
//		delay(100);
//		SoundAllCommand2(0x55,5,0,0);	//moderate hypertension
//		delay(100);
//		SoundAllCommand2(0x55,6,0,0);	//Severe hypertension
//		delay(100);

//		ShowWHO(test1,test2);
//		delay(10);
//		DarkAllIcon();

//		LBTIconOn;
//		delay(10);
//		LBTIconOff;

//		BTIconOn;
//		delay(10);
//		BTIconOff;	
//		(*((volatile  uint8 xdata *)(0xf001+test1)))|=(0x01+test2);
//			delay(10);
//			(*((volatile  uint8 xdata *)(0xf001+test1)))|=(0x01+test2);
//				delay(10);
	}
```


##### FY-B01
![[../../annex/17.入职第十七周11.3-11.7(双休)_image_5.png]]
FY_B01 加蓝牙（芯片为晶华微的芯片--BP 507），开发环境是蓝色的 CDK。其仿真用 CKLink 平头哥。

接线：
①TMS--SWCLK
②TCK--SWDIO
③GND--GND





##### 其他
###### P126
3.3 x 0.7
3.3 V 稳压 ic
100 K、100 K，250
上面的改成 62 K，70 K
0.6 几

###### 喇叭->蜂鸣器？
喇叭，内部线圈，几Ω
蜂鸣器，...Ω
有无限流电阻？
喇叭代替蜂鸣器寿命如何？

直流/交流驱动？






















































































































































































